{"version":3,"file":"../pages/news/[articleId].js","mappings":"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","sources":["webpack://fall-in-asia-clinet/./pages/news/[articleId]/index.tsx","webpack://fall-in-asia-clinet/./utils/html2textConverter.ts","webpack://fall-in-asia-clinet/external \"@ant-design/icons\"","webpack://fall-in-asia-clinet/external \"@emotion/react/jsx-runtime\"","webpack://fall-in-asia-clinet/external \"@emotion/styled/base\"","webpack://fall-in-asia-clinet/external \"@reduxjs/toolkit\"","webpack://fall-in-asia-clinet/external \"antd\"","webpack://fall-in-asia-clinet/external \"axios\"","webpack://fall-in-asia-clinet/external \"dayjs\"","webpack://fall-in-asia-clinet/external \"dayjs/locale/ko\"","webpack://fall-in-asia-clinet/external \"dayjs/plugin/relativeTime\"","webpack://fall-in-asia-clinet/external \"next-redux-wrapper\"","webpack://fall-in-asia-clinet/external \"next/router\"","webpack://fall-in-asia-clinet/external \"react\"","webpack://fall-in-asia-clinet/external \"react-html-parser\"","webpack://fall-in-asia-clinet/external \"react-map-gl\"","webpack://fall-in-asia-clinet/external \"react-redux\"","webpack://fall-in-asia-clinet/external \"react-scrollspy\"","webpack://fall-in-asia-clinet/external \"react-toastify\"","webpack://fall-in-asia-clinet/external \"swr\""],"sourcesContent":["import React, { FC, useCallback, useEffect, useState } from \"react\";\r\nimport styled from \"@emotion/styled\";\r\nimport ReactHtmlParser from \"react-html-parser\";\r\nimport { FLEX_STYLE, noRevalidate, toastErrorMessage, toastSuccessMessage } from \"config\";\r\nimport router, { useRouter } from \"next/router\";\r\nimport useSWR, { useSWRInfinite } from \"swr\";\r\nimport fetcher from \"utils/fetcher\";\r\nimport { IArticle } from \"@typings/db\";\r\nimport { Divider } from \"antd\";\r\nimport { wrapper } from \"configureStore\";\r\nimport axios from \"axios\";\r\nimport { getUserInfoAction } from \"actions/user\";\r\nimport PostLayout from \"@layout/PostLayout\";\r\nimport NewsArticleList from \"@sections/NewsPage/NewsArticleList\";\r\nimport PostThubnail from \"@components/Post/PostThubnail\";\r\nimport CountryMap from \"@components/Maps/CountryMap\";\r\nimport tw from \"twin.macro\";\r\nimport { toastConfirmMessage } from \"@components/ConfirmToastify\";\r\nimport { DeleteOutlined, EditOutlined } from \"@ant-design/icons\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"slices\";\r\nexport const NewsArticleWrapper = styled.div`\r\n  padding-top: 6rem;\r\n  .post-content {\r\n    user-select: none;\r\n    ${tw`pb-16 relative`}\r\n  }\r\n  .article-manage-wrapper {\r\n    ${FLEX_STYLE(\"center\", \"center\")};\r\n  }\r\n`;\r\n\r\ninterface IProps {\r\n  initialArticles: IArticle[][];\r\n  initialArticle: IArticle;\r\n}\r\nconst index: FC<IProps> = ({ initialArticle, initialArticles }) => {\r\n  const { query } = useRouter();\r\n  const [isOwner, setIsOwner] = useState(false);\r\n  const { user } = useSelector((state: RootState) => state.user);\r\n  const { data: article } = useSWR<IArticle>(`/article/${query?.articleId}`, fetcher, {\r\n    initialData: initialArticle,\r\n    ...noRevalidate,\r\n  });\r\n\r\n  const { data: articles, setSize } = useSWRInfinite<IArticle[]>(\r\n    (index) => `/article?page=${index + 1}`,\r\n    fetcher,\r\n    {\r\n      initialData: initialArticles,\r\n      ...noRevalidate,\r\n    }\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (user?.id === article?.user?.id) {\r\n      setIsOwner(true);\r\n    } else {\r\n      setIsOwner(false);\r\n    }\r\n  }, [user, article]);\r\n\r\n  useEffect(() => {\r\n    if (article) {\r\n      let contentHeaders = document.querySelectorAll(\r\n        \".post-content > h1 , .post-content > h2 ,.post-content > h3\"\r\n      );\r\n      contentHeaders.forEach((v, i) => {\r\n        const span = document.createElement(\"span\");\r\n        span.setAttribute(\"id\", `header_${i + 1}`);\r\n        span.classList.add(\"anchor-offset-controller\");\r\n        v.classList.add(\"anchor-offset-parent\");\r\n        v.appendChild(span);\r\n      });\r\n    }\r\n  }, [article]);\r\n\r\n  const onClickConfirmDelete = useCallback(() => {\r\n    if (user && isOwner) {\r\n      axios\r\n        .delete(`/article/${article?.id}`)\r\n        .then(() => {\r\n          toastSuccessMessage(\"연대기를 성공적으로 삭제했습니다.\");\r\n          router.push(`/news`);\r\n        })\r\n        .catch((error) => {\r\n          toastErrorMessage(error);\r\n          throw error;\r\n        });\r\n    }\r\n  }, [user, isOwner, article]);\r\n\r\n  const onClickEditBtn = useCallback(() => {\r\n    if (user && isOwner) {\r\n      router.push(`/news/post?articleId=${query?.articleId}`);\r\n    }\r\n  }, [user, isOwner, query]);\r\n\r\n  return (\r\n    <NewsArticleWrapper>\r\n      <PostLayout>\r\n        {article && (\r\n          <>\r\n            <PostThubnail article={article} />\r\n            {isOwner && (\r\n              <>\r\n                <h2 className=\"main-title\">관리 (운영자 전용)</h2>\r\n                <div className=\"article-manage-wrapper\">\r\n                  <button onClick={onClickEditBtn} className=\"edit-btn\">\r\n                    <EditOutlined />\r\n                    기사 수정\r\n                  </button>\r\n                  <button\r\n                    onClick={() =>\r\n                      toastConfirmMessage(\r\n                        onClickConfirmDelete,\r\n                        \"정말 이 기사를 삭제할까요?\",\r\n                        \"삭제해주세요.\"\r\n                      )\r\n                    }\r\n                    className=\"delete-btn\"\r\n                  >\r\n                    <DeleteOutlined />\r\n                    기사 삭제\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n            <h2 className=\"main-title\">\r\n              위치 <span>{article?.region}</span>\r\n            </h2>\r\n            <CountryMap lat={article?.lat} lng={article?.lng} />\r\n            <Divider />\r\n            <article className=\"post-content\">\r\n              <span id=\"main_post\" className=\"anchor-offset-controller\" />\r\n              {ReactHtmlParser(article?.content as string)}\r\n            </article>\r\n          </>\r\n        )}\r\n        <div style={{ marginBottom: \"2rem\" }} />\r\n        <NewsArticleList setSize={setSize} articles={articles} />\r\n      </PostLayout>\r\n    </NewsArticleWrapper>\r\n  );\r\n};\r\n\r\nexport const getServerSideProps = wrapper.getServerSideProps(\r\n  (store) =>\r\n    async ({ req, res, params }) => {\r\n      const cookie = req ? req.headers.cookie : \"\";\r\n      axios.defaults.headers.Cookie = \"\";\r\n      if (req && cookie) {\r\n        axios.defaults.headers.Cookie = cookie;\r\n      }\r\n      await store.dispatch(getUserInfoAction());\r\n      let initialArticles = await fetcher(`/article?page=1`);\r\n      initialArticles = [initialArticles];\r\n      const initialArticle = await fetcher(`/article/${params?.articleId}`);\r\n      return {\r\n        props: { initialArticles, initialArticle },\r\n      };\r\n    }\r\n);\r\n\r\nexport default index;\r\n","export default function html2textConverter(content?: string): string {\r\n  return content?.replace(/(<([^>]+)>)/gi, \"\").replaceAll(/&nbsp;|&amp;/gi, \"\") || \"\";\r\n}\r\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"@emotion/react/jsx-runtime\");","module.exports = require(\"@emotion/styled/base\");","module.exports = require(\"@reduxjs/toolkit\");","module.exports = require(\"antd\");","module.exports = require(\"axios\");","module.exports = require(\"dayjs\");","module.exports = require(\"dayjs/locale/ko\");","module.exports = require(\"dayjs/plugin/relativeTime\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-html-parser\");","module.exports = require(\"react-map-gl\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-scrollspy\");","module.exports = require(\"react-toastify\");","module.exports = require(\"swr\");"],"names":["React","useCallback","useEffect","useState","ReactHtmlParser","FLEX_STYLE","noRevalidate","toastErrorMessage","toastSuccessMessage","router","useRouter","useSWR","useSWRInfinite","fetcher","Divider","wrapper","axios","getUserInfoAction","PostLayout","NewsArticleList","PostThubnail","CountryMap","toastConfirmMessage","DeleteOutlined","EditOutlined","useSelector","NewsArticleWrapper","index","initialArticle","initialArticles","query","isOwner","setIsOwner","user","state","data","article","articleId","initialData","articles","setSize","id","contentHeaders","document","querySelectorAll","forEach","v","i","span","createElement","setAttribute","classList","add","appendChild","onClickConfirmDelete","delete","then","push","catch","error","onClickEditBtn","region","lat","lng","content","marginBottom","getServerSideProps","store","req","res","params","cookie","headers","defaults","Cookie","dispatch","props","html2textConverter","replace","replaceAll"],"sourceRoot":""}