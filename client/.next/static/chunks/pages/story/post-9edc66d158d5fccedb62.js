(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{19200:function(t,e,n){"use strict";n.r(e),n.d(e,{__N_SSP:function(){return y},StoryPostWrapper:function(){return S}});var i=n(35944),o=n(53672),a=n(42106),r=n(67294),l=n(2584),d=n(32599),u=n(49226),c=n(53215),s=n(11163),v=n(96996),p=n(79709),g=n(48818),h=n(84608),m=n(68681),f=n(98981),b=n(36243),Z=n(9669),w=n.n(Z),y=!0,S=(0,a.Z)("div",{target:"e6sme1z0"})(".title-input{padding:0.63rem 1rem;}.autoComplete-form{width:20%;}.editor-btn-wrapper{margin-top:1rem;",(0,c.Yk)("flex-end","center")," button{--tw-bg-opacity:1;background-color:rgba(255, 255, 255, var(--tw-bg-opacity));padding-top:0.75rem;padding-bottom:0.75rem;padding-left:1.5rem;padding-right:1.5rem;font-weight:700;margin-left:0.5rem;border-radius:0.75rem;:hover{--tw-shadow:0px 0px 5px rgba(0, 0, 0, 0.15);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);} ",(0,c.h_)("border"),";transition:0.3s all;}}.mapboxgl-ctrl-geocoder--button{border-radius:9999px;;}.dragger{height:40vh;}");e.default=function(){var t=(0,s.useRouter)().query,e=(0,u.v9)((function(t){return t.user})).user,n=(0,g.ZP)("/country",h.Z,c.nb).data,a=(0,g.ZP)(null!==t&&void 0!==t&&t.storyId?"/story/".concat(null===t||void 0===t?void 0:t.code,"/").concat(null===t||void 0===t?void 0:t.storyId):null,h.Z,c.nb).data,Z=(0,r.useState)(""),y=Z[0],_=Z[1],k=(0,f.Z)(""),N=(0,o.Z)(k,3),C=N[0],x=N[1],E=N[2],P=(0,r.useState)(),I=(P[0],P[1]),X=(0,r.useState)([]),L=X[0],O=X[1],T=(0,r.useState)("\uc774\ub984\ubaa8\ub97c \uc5b4\ub518\uac00"),B=T[0],F=T[1],M=(0,r.useState)(""),R=M[0],q=M[1],z=(0,r.useState)(""),D=z[0],U=z[1],W=(0,r.useState)({latitude:37.50529626491968,longitude:126.98047832475031}),Y=W[0],j=W[1],A=(0,r.useMemo)((function(){return null===n||void 0===n?void 0:n.map((function(t,e){return{value:t.name,code:t.code}}))}),[n]);(0,r.useEffect)((function(){var t;a&&(F(null===a||void 0===a?void 0:a.region),E(null===a||void 0===a?void 0:a.title),U(null===a||void 0===a?void 0:a.content),_(null===a||void 0===a||null===(t=a.country)||void 0===t?void 0:t.name),j({latitude:null===a||void 0===a?void 0:a.lat,longitude:null===a||void 0===a?void 0:a.lng}),null!==a&&void 0!==a&&a.thumbnail&&(O([{uid:"1",name:"\uc378\ub124\uc77c",status:"done",url:a.thumbnail}]),I(a.thumbnail)))}),[a]),(0,r.useEffect)((function(){var t;(e||s.default.back(),a)&&((null===e||void 0===e?void 0:e.id)!==(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.id)&&s.default.back())}),[e,a]);var G=(0,r.useCallback)((function(){if(C)if(B)if(D){var t=new FormData;R&&t.append("image",R),t.append("title",String(C)),t.append("region",String(B)),t.append("content",String(D)),t.append("lat",String(Y.latitude)),t.append("lng",String(Y.longitude));var e=null===A||void 0===A?void 0:A.find((function(t){return t.value===y}));e?(t.append("code",String(e.code)),a&&t.append("storyId",String(null===a||void 0===a?void 0:a.id)),w().post("/story/".concat(a?"edit":""),t).then((function(t){var n=t.data.data.storyId;s.default.push("/story/".concat(null===e||void 0===e?void 0:e.code,"/").concat(n)),scrollTo({top:0}),F(""),q(""),E(""),U(""),_(""),a?(0,c.bi)("\uc5f0\ub300\uae30\ub97c \uc218\uc815\ud588\uc2b5\ub2c8\ub2e4."):(0,c.bi)("\uc5f0\ub300\uae30\ub97c \uc131\uacf5\uc801\uc73c\ub85c \uc791\uc131\ud588\uc2b5\ub2c8\ub2e4.")})).catch((function(t){throw(0,c.p4)(t),t}))):(0,c.p4)("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \uad6d\uac00\uc785\ub2c8\ub2e4. \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.")}else(0,c.p4)("\ub0b4\uc6a9\uc744 \uc791\uc131\ud574\uc8fc\uc138\uc694.");else(0,c.p4)("\uc9c0\ub3c4\uc5d0\uc11c \uc9c0\uc5ed\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");else(0,c.p4)("\uc81c\ubaa9\uc744 \uc791\uc131\ud574\uc8fc\uc138\uc694.")}),[C,B,A,y,D,R,Y,a]);return(0,i.tZ)(S,{children:(0,i.BX)(l.Z,{children:[(0,i.tZ)("h2",{className:"main-title",children:"\uc81c\ubaa9"}),(0,i.tZ)("input",{value:C,onChange:x,placeholder:"\uc5f0\ub300\uae30 \uc81c\ubaa9 \uc785\ub825",className:"basic-input title-input",type:"text"}),(0,i.tZ)("h2",{className:"main-title",children:"\uad6d\uac00 \uc9c0\uc815"}),(0,i.tZ)(p.Z,{countryOptions:A,selectedCountry:y,setCountry:_}),(0,i.tZ)("h2",{className:"main-title",children:"\uc9c0\uc5ed \uc9c0\uc815"}),(0,i.tZ)(v.Z,{lat:null===a||void 0===a?void 0:a.lat,lng:null===a||void 0===a?void 0:a.lng,marker:Y,setMarker:j,setRegion:F}),(0,i.tZ)("h2",{className:"main-title",children:"\uc120\ud0dd \uc9c0\uc5ed"}),(0,i.tZ)("h3",{children:B}),(0,i.tZ)("h2",{className:"main-title",children:"\ub0b4\uc6a9\uc791\uc131"}),(0,i.tZ)(d.Z,{prevContent:null===a||void 0===a?void 0:a.content,setContent:U,isStory:!0}),(0,i.tZ)("h2",{className:"main-title",children:a?"\uc378\ub124\uc77c \ubcc0\uacbd":"\uc378\ub124\uc77c \uc5c5\ub85c\ub4dc"}),(0,i.tZ)(m.Z,{fileList:L,setFileList:O,setPrevImageList:I,setUpImg:q,single:!0}),(0,i.BX)("div",{className:"editor-btn-wrapper",children:[(0,i.tZ)("button",{onClick:function(){return s.default.back()},children:"\ub4a4\ub85c\uac00\uae30"}),(0,i.tZ)("button",{onClick:function(){37.50529626491968===Y.latitude&&126.98047832475031===Y.longitude?(0,b.u)(G,"\uc9c0\uc5ed \uc88c\ud45c\ub97c \uc785\ub825\ud558\uc9c0 \uc54a\uc73c\uc168\uc5b4\uc694, \uc774\uc0c1\ud0dc\ub85c \uc9c4\ud589\ud560\uae4c\uc694? (\ud604\uc7ac \uc88c\ud45c : \ub300\ud55c\ubbfc\uad6d \uc11c\uc6b8 , \uc774\ub984\ubaa8\ub97c \uc5b4\ub518\uac00)","\uc9c4\ud589\ud574\uc8fc\uc138\uc694"):G()},children:a?"\uc5f0\ub300\uae30 \uc218\uc815":"\uc5f0\ub300\uae30 \uc5c5\ub85c\ub4dc"})]})]})})}},75408:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/story/post",function(){return n(19200)}])}},function(t){t.O(0,[634,937,215,818,737,764,150,258,930,774,888,179],(function(){return e=75408,t(t.s=e);var e}));var e=t.O();_N_E=e}]);